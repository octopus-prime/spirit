# Copyright 2016, 2017 Peter Dimov
# Distributed under the Boost Software License, Version 1.0.
# (See accompanying file LICENSE_1_0.txt or copy at http://boost.org/LICENSE_1_0.txt)

# When copying this to a new library, be sure to update the name of the library
# in two places (once each at the top of install: and test_script:)

version: 1.0.{build}-{branch}

shallow_clone: true

#branches:
#  only:
#    - develop
#    - master

image:
  - Visual Studio 2017
  - Visual Studio 2015
  - Visual Studio 2013

matrix:
  fast_finish: true

install:
  - set SELF=spirit
  - cd ..
  - git clone -j2 --branch=develop --depth=1 --quiet --recurse-submodules=":(exclude)libs/%SELF%" --shallow-submodules https://github.com/boostorg/boost.git boost-root
  - cd boost-root
  - xcopy /s /e /q /Y %APPVEYOR_BUILD_FOLDER% libs\%SELF%
  - cmd /c bootstrap
  - b2 headers

build: off

test_script:
  - set SELF=spirit
  - PATH=%ADDPATH%%PATH%
  - b2 libs/%SELF%/test address-model=64 link=shared threading=multi variant=release -j2
